# üéØ PULL-MODEL –ù–ê–°–¢–†–û–ô–ö–ê - –ë–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

## ‚úÖ –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ **PULL-MODEL –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É**:
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∞–º–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —á–µ—Ä–µ–∑ TonConnect
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –æ–ø–ª–∞—á–∏–≤–∞—é—Ç gas fees –∏–∑ —Å–≤–æ–∏—Ö –∫–æ—à–µ–ª—å–∫–æ–≤
- ‚úÖ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ç–æ–ª—å–∫–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç intent'—ã
- ‚úÖ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ù–ï —Ö—Ä–∞–Ω–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏
- ‚úÖ –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã

## üìã –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

### –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
TON_CONTRACT_ADDRESS=<–∞–¥—Ä–µ—Å_escrow_–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞>
GSTD_JETTON_ADDRESS=<–∞–¥—Ä–µ—Å_gstd_jetton>
TON_API_URL=https://tonapi.io
TON_API_KEY=<–≤–∞—à_api_key>

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω—ã admin –æ–ø–µ—Ä–∞—Ü–∏–∏)
PLATFORM_WALLET_ADDRESS=<–≤–∞—à_–∞–¥—Ä–µ—Å>  # –¢–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å, –ë–ï–ó –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞

# –ù–ï –ù–£–ñ–ù–û:
# PLATFORM_WALLET_PRIVATE_KEY - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
# PLATFORM_WALLET_SEED - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
```

### –í–∞—à –∫–æ—à–µ–ª–µ–∫ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–º–µ—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –∫–æ—à–µ–ª–µ–∫ –¥–ª—è admin –æ–ø–µ—Ä–∞—Ü–∏–π:

1. **–°–æ–∑–¥–∞–π—Ç–µ –∫–æ—à–µ–ª–µ–∫ —Å–∞–º–∏** (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Tonkeeper, Tonhub –∏–ª–∏ –¥—Ä—É–≥–æ–π –∫–æ—à–µ–ª–µ–∫)
2. **–î–æ–±–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å** –≤ `.env`:
   ```bash
   PLATFORM_WALLET_ADDRESS=EQ...  # –í–∞—à –∞–¥—Ä–µ—Å
   ```
3. **–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ TON –¥–ª—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤**:
   - –í—ã –ø–æ–ª—É—á–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
   - –í—ã –ø–æ–¥–ø–∏—à–µ—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ —Å–≤–æ–π –∫–æ—à–µ–ª–µ–∫
   - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

## üîÑ –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ PULL-MODEL

### –î–ª—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π (Workers)

1. **Worker –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞—á—É** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
2. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç** ‚Üí –∑–∞–¥–∞—á–∞ –ø–æ–º–µ—á–∞–µ—Ç—Å—è –∫–∞–∫ `validated`
3. **Worker –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç payout intent**:
   ```bash
   POST /api/v1/payments/payout-intent
   {
     "task_id": "task_123",
     "executor_address": "EQ..."
   }
   ```
4. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç intent**:
   ```json
   {
     "to_address": "ESCROW_CONTRACT",
     "amount_nano": 10000000,  // 0.01 TON –¥–ª—è gas
     "payload_comment": "WITHDRAW|task:...|exec:...|fee:...|reward:...",
     "executor_reward_ton": 0.95,
     "platform_fee_ton": 0.05,
     "task_id": "task_123",
     "executor_address": "EQ..."
   }
   ```
5. **Worker –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ TonConnect**:
   - Worker –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TonConnect UI
   - Worker –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —Å–≤–æ–∏–º –∫–æ—à–µ–ª—å–∫–æ–º
   - Worker –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç gas fees (~0.01-0.1 TON)
6. **Escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏**:
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 95% –Ω–∞–≥—Ä–∞–¥—ã worker'—É
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç 5% –∫–æ–º–∏—Å—Å–∏–∏ –≤ treasury
   - –í—Å–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –≤ –±–ª–æ–∫—á–µ–π–Ω–µ

### –î–ª—è –∑–∞–∫–∞–∑—á–∏–∫–æ–≤ (Requesters)

1. **Requester —Å–æ–∑–¥–∞–µ—Ç –∑–∞–¥–∞—á—É** ‚Üí —á–µ—Ä–µ–∑ API
2. **Requester –±–ª–æ–∫–∏—Ä—É–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç TON –≤ escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç
3. **Workers –≤—ã–ø–æ–ª–Ω—è—é—Ç** ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç** ‚Üí —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. **Workers –∑–∞–±–∏—Ä–∞—é—Ç –Ω–∞–≥—Ä–∞–¥—ã** ‚Üí —á–µ—Ä–µ–∑ pull-model (—Å–º. –≤—ã—à–µ)

## üí∞ –ö–û–ú–ò–°–°–ò–ò –ò GAS FEES

### Gas Fees
- **–û–ø–ª–∞—á–∏–≤–∞–µ—Ç**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (worker –∏–ª–∏ requester)
- **–†–∞–∑–º–µ—Ä**: ~0.01-0.1 TON –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ù–ï –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç**: –í—Å–µ gas fees –æ–ø–ª–∞—á–∏–≤–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

### Platform Fee
- **–†–∞–∑–º–µ—Ä**: 5% –æ—Ç –Ω–∞–≥—Ä–∞–¥—ã
- **–°–±–æ—Ä**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º
- **–ü–æ–ª—É—á–∞—Ç–µ–ª—å**: Treasury wallet (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ)

## üîí –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –ß—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ù–ï –¥–µ–ª–∞–µ—Ç:
- ‚ùå –ù–µ —Ö—Ä–∞–Ω–∏—Ç –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏
- ‚ùå –ù–µ –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚ùå –ù–µ –æ–ø–ª–∞—á–∏–≤–∞–µ—Ç gas fees
- ‚ùå –ù–µ –∏–º–µ–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ä–µ–¥—Å—Ç–≤–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ß—Ç–æ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–µ–ª–∞–µ—Ç:
- ‚úÖ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç payout intent'—ã
- ‚úÖ –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–¥–∞—á
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è intent'–æ–≤

## üöÄ –ó–ê–ü–£–°–ö

### 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

```bash
# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
TON_CONTRACT_ADDRESS=<escrow_contract>
GSTD_JETTON_ADDRESS=<gstd_jetton>
TON_API_URL=https://tonapi.io
TON_API_KEY=<api_key>

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ (—Ç–æ–ª—å–∫–æ –∞–¥—Ä–µ—Å, –±–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞)
PLATFORM_WALLET_ADDRESS=<–≤–∞—à_–∞–¥—Ä–µ—Å>
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É

```bash
docker-compose up -d
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

```bash
docker-compose logs -f backend
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
‚ÑπÔ∏è  PULL-MODEL: JettonTransferService not needed - users sign transactions themselves
   Workers claim rewards via escrow contract using TonConnect
   Platform only generates payout intents, users pay gas fees
```

## üìù API ENDPOINTS

### –ü–æ–ª—É—á–∏—Ç—å payout intent

```bash
POST /api/v1/payments/payout-intent
Content-Type: application/json

{
  "task_id": "task_123",
  "executor_address": "EQ..."
}
```

**Response**:
```json
{
  "to_address": "ESCROW_CONTRACT",
  "amount_nano": 10000000,
  "payload_comment": "WITHDRAW|task:task_123|exec:EQ...|fee:50000000|reward:950000000",
  "executor_reward_ton": 0.95,
  "platform_fee_ton": 0.05,
  "task_id": "task_123",
  "executor_address": "EQ..."
}
```

## üéØ ESCROW –ö–û–ù–¢–†–ê–ö–¢

Escrow –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–¥–µ–ø–ª–æ–µ–Ω –Ω–∞ TON blockchain.

**–§—É–Ω–∫—Ü–∏–∏**:
- –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –¥–µ–ø–æ–∑–∏—Ç—ã –æ—Ç requesters
- –í—ã–ø–ª–∞—á–∏–≤–∞–µ—Ç –Ω–∞–≥—Ä–∞–¥—ã workers –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ Withdraw —Å–æ–æ–±—â–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç platform fee –≤ treasury
- –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç replay –∞—Ç–∞–∫ (nonce)
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å–∏

**–ê–¥—Ä–µ—Å –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞**: –£–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ `TON_CONTRACT_ADDRESS`

## ‚úÖ –°–¢–ê–¢–£–°

‚úÖ **–ì–û–¢–û–í–û –ö –†–ê–ë–û–¢–ï**:
- PULL-MODEL –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–∞–º–∏
- Gas fees –æ–ø–ª–∞—á–∏–≤–∞—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

‚úÖ **–ù–ï –ù–£–ñ–ù–û**:
- ‚ùå –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚ùå Seed phrase –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
- ‚ùå –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–æ—à–µ–ª—å–∫–∞ –¥–ª—è –≤—ã–ø–ª–∞—Ç
- ‚ùå –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã

---

**–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≥–æ—Ç–æ–≤–∞ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞!** üéâ

–ü—Ä–æ—Å—Ç–æ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ `TON_CONTRACT_ADDRESS` –∏ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ!

